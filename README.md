# SIEM Threat Detection with Splunk + Wireshark

## Short project summary
Simulate a realistic SSH brute force attack from an attacker VM (Kali) against a victim VM (Ubuntu), ingest Ubuntu authentication syslogs into Splunk in real time via rsyslog, detect and visualize failed SSH authentication activity, and validate detections at the packet level using tcpdump and Wireshark PCAPs. This repository is a compact, repeatable purple-team lab for detection, incident response practice, and demos.

## What I did
- Built two VMs on an isolated private network: **Kali (attacker)** and **Ubuntu (victim)**.
- Configured Ubuntu rsyslog to forward authentication syslogs into a local Splunk instance.
- Generated SSH brute force attempts from Kali against Ubuntu using repeated invalid credentials.
- Captured packets on the victim with tcpdump and validated failed SSH handshakes in Wireshark.
- Built Splunk searches and a dashboard to detect and visualize attack activity in near real time.
- Recorded a short demo video walking through the simulation, detections, and packet-level validation.

## Key results (high level)
- Ingested 1.5K+ authentication events including failed SSH attempts.
- Created a Splunk regex-based search to extract source IP and username from raw syslog lines.
- Detected conditions such as 3 or more failed logins per minute from a single source and surfaced them in a real-time dashboard.
- Correlated Splunk detections with Wireshark PCAP evidence to validate attacker tradecraft at both log and packet levels.

## Splunk search example
```spl
index=ubuntu_syslog sourcetype=syslog "sshd" "Failed password"
| rex field=_raw "Failed password for (invalid user )?(?<user>\S+) from (?<src_ip>\S+)"
| stats count by src_ip, user
| sort -count
```
This query extracts the failing username and source IP, then counts failures per source. Use it as a basis for dashboards, thresholds, and alerts.

## Why this is useful
- Practice detection and incident response workflows in a repeatable lab.
- Demonstrate how log-based detection and packet-level validation complement each other.
- Useful for interview demos, defender training, or building more advanced detection pipelines.

## Tools and technologies used
- Splunk Enterprise (local)
- Ubuntu server (rsyslog)
- Kali Linux (attack simulation)
- tcpdump / Wireshark
- nmap for reconnaissance during simulation (optional)
- tshark for automated PCAP extraction (optional)

## Repo contents
- `README.md` - this file
- `SETUP.md` - precise VM downloads, VirtualBox networking, Splunk config, rsyslog edits, and copy/paste commands to reproduce the simulation
- `DEMO.md` - demo video link and short transcript
- `pcap/` - packet captures used for validation (example: `ssh_attempts.pcap`)
- `splunk/` - sample saved searches, dashboard JSON, and alert configurations
- `scripts/` - helper scripts (tcpdump capture, simple SSH attempt loop for testing)
- `LICENSE` - license for the repository
- `ETHICS.md` - responsible use guidance and rules of engagement

## Quick reproduction checklist
1. Provision two VMs on an isolated network: Kali and Ubuntu.
2. Install Splunk and enable a TCP or UDP syslog listener on the port you prefer.
3. Configure `/etc/rsyslog.conf` on Ubuntu to forward logs to the Splunk listener.
4. From Kali, run repeated SSH attempts against the Ubuntu host:
   `ssh invaliduser@<ubuntu-ip>`
   Repeat with incorrect passwords to generate failed auth events.
5. Capture packets on Ubuntu:
   `sudo tcpdump -i <iface> port 22 -w pcap/ssh_attempts.pcap`
6. Run the Splunk query above and import the provided dashboard JSON.
7. Review both Splunk logs and the PCAP to confirm correlation.

For exact commands, copy/pasteable configs, Splunk settings, and screenshots, see `SETUP.md`.

## Demo
A short demo video will be added to `DEMO.md`. The demo will show:
- The attacker issuing SSH attempts from Kali.
- Real-time ingestion in Splunk and the query returning failed authentication counts.
- Dashboard panels showing top source IPs, usernames, and a timeline of spikes.
- Wireshark evidence of failed SSH handshake attempts in the PCAP.

## Responsible use
This project is for education and defensive testing only. Only run these simulations on systems you own or where you have explicit permission. Do not target third-party networks or systems without written authorization.

If you publish findings that include suspect external IPs, follow responsible disclosure processes and your organizationâ€™s incident handling procedures before publicizing.

## Attribution
PCAPs and examples were generated by the author during lab work and adapted for demonstration purposes. Parts of this project draw on lab exercises from network forensics and SIEM training materials.

## License
Choose a license for this repository. Recommended options: MIT or Apache 2.0. If you want, I can add a templated LICENSE file.
